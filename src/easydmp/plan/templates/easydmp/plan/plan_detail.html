{% extends "easydmp/plan/base.html" %}
{% block content %}
  <div class="row">
    <div class="col-lg-12">
      <div class="jumbotron uninett-color-darkBlue uninett-pattern1">
          <h1>{{ object.title|capfirst }}</h1>
      </div>
    </div>
  </div>

  <!-- Summary Box -->
  <div class="row uninett-color-white uninett-whole-row">
    <div class="col-lg-12 col-md-12 uninett-color-white uninett-padded gutter">
        <div id="summary_header">
          <h2>Plan overview</h2>
          <div class="actions dropdown">
            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1" data-toggle="dropdown" aria-haspopup="true" aria-expanded="true">
              Actions
            <span class="caret"></span>
            </button>
            <ul class="dropdown-menu" aria-labelledby="dropdownMenu1">
              <li><a id="action_html" href="{% url 'generated_plan_html' plan=object.id %}">Generated HTML</a></li>
              <li><a id="action_invite" href="{% url 'invitation_plan_editor_create' plan=object.id %}">Invite</a></li>
              <li><a id="action_rename" href="{% url 'update_plan' plan=object.id %}">Rename</a></li>
              <li><a id="action_save_as" href="{% url 'plan_saveas' plan=object.id %}">Save As</a></li>
              <li><a id="action_delete" href="{% url 'plan_delete' plan=object.id %}">Delete</a></li>
            </ul>
          </div>
        </div>
        {% if output.items %}
        <div class="dmpsummary">
            {% for section_title, sectiondata in output.items %}
            <div class="section section_depth_{{ sectiondata.section.depth }} " id="{{ sectiondata.section.full_title|slugify }}">
                <h3 class="section_title"><a href="{% url 'section_detail' section=sectiondata.section.pk plan=object.id %}">{{ sectiondata.section.full_title }}</a></h3>
                {% if sectiondata.section.introductory_text %}
                <div class="section_introduction">{{ sectiondata.section.introductory_text }}</div>
                {% endif %}
                {% if sectiondata.section.comment %}
                <div class="section_comment"><td colspan="3">{{ sectiondata.section.comment }}</div>
                {% endif %}
                {% if sectiondata.data %}
                {% for question_pk, value in sectiondata.data.items %}
                <dl class="questionrow">
                    <dt class="question">{{ value.question }}</dt>
                    <dd class="answer">{{ value.answer }}
                        {% if value.notes %}<br />
                        <div class="notes">
                            <b>Notes:</b>
                            {{ value.notes }}
                        </div>
                        {% endif %}
                        {% if not object.locked %}
                    <p class="actions"><a href="{% url 'new_question' plan=object.id question=question_pk %}">Edit</a></p>
                        {% endif %}
                    </dd>
                </dl>
                {% endfor %}
                {% else %}
                {% if sectiondata.section.first_question %}
                {% with sectiondata.section.first_question as question %}
                <p>You have not answered any of the question in this section yet. A link to the first question follows below.</p>
                <dl class="questionrow">
                    <dt class="question">{{ question }}</dt>
                    <dd class="answer">
                        {% if not object.locked %}
                    <p class="actions"><a href="{% url 'new_question' plan=object.id question=question.pk %}">New</a></p>
                        {% endif %}
                    </dd>
                </dl>
                {% endwith %}
                {% endif %}
                {% endif %}
                </div>
                {% endfor %}
        </div>
        {% else %}
        <p>No questions answered. <a href="{% url 'first_question' plan=object.id %}">Start here</a>.</p>
        {% endif %}
    </div>
  </div>

  <!-- Editors Box -->
  <div class="row uninett-color-white uninett-whole-row">
    <div class="col-lg-12 col-md-12 uninett-color-white uninett-padded gutter">
        <h2>Editors</h2>
        <ul>
        {% for user in object.editor_group.user_set.all %}
        <li>{{ user }}
        {% endfor %}
        </ul>

        <p><a href="{% url 'invitation_plan_editor_create' plan=object.pk %}">Invite editors to this plan</a></p>
        <p><a href="{% url 'invitation_plan_editor_list' plan=object.pk %}">Show invitations</a></p>
    </div>
  </div>

<div>
    <br />
    <br />
</div>
{% endblock content %}
